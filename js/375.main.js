(()=>{"use strict";var e,t,r={375:(e,t,r)=>{var n=r(941);class s{state=null;children=[];parent=null;move={};v=0;N=0;n=0}const o=new n.qQ,l=new class{predict(e,t,r,o=6){if(t)return-1;let l=e.state.moves(),a={},i=e.state.fen();for(l.forEach((t=>{let r=new n.qQ(i),o=r.move(t),l=new s;l.state=r,l.parent=e,l.move=o,e.children.push(l),a[t]=l}));o>0;){if(r){let t=Number.MIN_SAFE_INTEGER,r=null;for(const n in e.children){const s=e.children[n];let o=this.#e(s);o>=t&&(t=o,r=s)}let n=this.#t(r,0);const{reward:s,state:o}=this.#r(n);e=this.#n(o,s)}else{let t=Number.MAX_SAFE_INTEGER,r=null;for(const n in e.children){const s=e.children[n];let o=this.#e(s);o<=t&&(t=o,r=s)}let n=this.#t(r,1);const{reward:s,state:o}=this.#r(n);e=this.#n(o,s)}o--}let c="";if(r){let t=Number.MIN_SAFE_INTEGER;for(const r in e.children){const n=e.children[r];let s=this.#e(n);if(s>t){t=s;for(const e in a)if(n==a[e]){c=e;break}}}}else{let t=Number.MAX_SAFE_INTEGER;for(const r in e.children){const n=e.children[r];let s=this.#e(n);if(s<t){t=s;for(const e in a)if(n==a[e]){c=e;break}}}}return c}#t(e,t){if(0==e.children.length)return e;if(t){let t=Number.MIN_SAFE_INTEGER,r=null;for(const n in e.children){const s=e.children[n];let o=this.#e(s);o>t&&(t=o,r=s)}return this.#t(r,0)}{let t=Number.MAX_SAFE_INTEGER,r=null;for(const n in e.children){const s=e.children[n];let o=this.#e(s);o<t&&(t=o,r=s)}return this.#t(r,1)}}#r(e){if(e.state.game_over()){let t;return e.state.in_checkmate()||e.state.in_stalemate()?t="w"==e.state.turn()?-1:1:e.state.in_draw()?t=.5:e.state.in_threefold_repetition()&&(t=0),{reward:t,state:e}}let t=e.state.moves(),r=e.state.fen();t.forEach((t=>{let o=new n.qQ(r),l=o.move(t),a=new s;a.parent=e,a.state=o,a.move=l,e.children.push(a)}));let o=Math.floor(Math.random()*e.children.length),l=e.children[o];return this.#r(l)}#n(e,t){for(;null!=e.parent;)e.state.in_check()&&("w"==e.state.turn()?t-=.8:t+=.8),e.n++,e.v+=t,(e=e.parent).N++;return e}#e(e){let t,r=e.v;return t="b"==e.state.turn()?1.5*Math.sqrt(Math.log(e.N+Math.E+Math.pow(10,-8))/(e.n+Math.floor(4*Math.random()+1))):-1.5*Math.sqrt(Math.log(e.N+Math.E+Math.pow(10,-8))/(e.n+Math.floor(4*Math.random()+1))),r+=t,r+=.8*this.#s(e.state),r+=.5*this.#o(e.state),r+=.7*this.#l(e.state),r}#s(e){let t=e.fen().split(" ")[0],r=(t.match(/P/g)||[]).length+3*(t.match(/N/g)||[]).length+3*(t.match(/B/g)||[]).length+5*(t.match(/R/g)||[]).length+9*(t.match(/Q/g)||[]).length+35*(t.match(/K/g)||[]).length,n=(t.match(/p/g)||[]).length,s=3*(t.match(/n/g)||[]).length,o=3*(t.match(/b/g)||[]).length,l=5*(t.match(/r/g)||[]).length;return r-(9*(t.match(/q/g)||[]).length+l+o+s+n+35*(t.match(/K/g)||[]).length)}#o(e){let t=e.turn(),r=e.fen(),n=0,s=0;return e.undo(),"w"==t?(n=e.moves().length,e.load(r),s=e.moves().length):(s=e.moves().length,e.load(r),n=e.moves().length),s-n}#l(e){let t=0;return e.moves({verbose:!0}).filter((e=>"c"==e.flags)).forEach((r=>{"w"==e.turn()?"w"==r.color&&(t=1*this.#a(r.captured)):"b"==r.color&&(t=1*this.#a(r.captured))})),t}#i(e){let t=0,r=e.moves({verbose:!0}).filter((e=>"pc"==e.flags||"p"==e.flags));return t="w"==e.turn()?r.length*this.#a("q"):-1*r.length*this.#a("q"),t}#a(e){switch(e){case"P":case"p":return 1;case"B":case"b":case"N":case"n":return 3;case"R":case"r":return 5;case"Q":case"q":return 9;case"K":case"k":return 35}}};let a=!0;for(;!o.game_over();){const e=new s;e.state=o,a?console.log("white is deciding"):console.log("black is deciding");let t=l.predict(e,o.game_over(),a),r=o.move(t);self.postMessage({type:"move",move:r}),a=!a}console.log(o.pgn()),self.postMessage({type:"finished",is_draw:o.in_draw()||o.in_threefold_repetition(),turn:o.turn(),is_checkmate:o.in_checkmate()||o.in_stalemate()})}},n={};function s(e){var t=n[e];if(void 0!==t)return t.exports;var o=n[e]={exports:{}};return r[e](o,o.exports,s),o.exports}s.m=r,s.x=()=>{var e=s.O(void 0,[941],(()=>s(375)));return s.O(e)},e=[],s.O=(t,r,n,o)=>{if(!r){var l=1/0;for(h=0;h<e.length;h++){for(var[r,n,o]=e[h],a=!0,i=0;i<r.length;i++)(!1&o||l>=o)&&Object.keys(s.O).every((e=>s.O[e](r[i])))?r.splice(i--,1):(a=!1,o<l&&(l=o));if(a){e.splice(h--,1);var c=n();void 0!==c&&(t=c)}}return t}o=o||0;for(var h=e.length;h>0&&e[h-1][2]>o;h--)e[h]=e[h-1];e[h]=[r,n,o]},s.d=(e,t)=>{for(var r in t)s.o(t,r)&&!s.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},s.f={},s.e=e=>Promise.all(Object.keys(s.f).reduce(((t,r)=>(s.f[r](e,t),t)),[])),s.u=e=>e+".main.js",s.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),s.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{var e;s.g.importScripts&&(e=s.g.location+"");var t=s.g.document;if(!e&&t&&(t.currentScript&&(e=t.currentScript.src),!e)){var r=t.getElementsByTagName("script");r.length&&(e=r[r.length-1].src)}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),s.p=e})(),(()=>{var e={375:1};s.f.i=(t,r)=>{e[t]||importScripts(s.p+s.u(t))};var t=self.webpackChunkchess=self.webpackChunkchess||[],r=t.push.bind(t);t.push=t=>{var[n,o,l]=t;for(var a in o)s.o(o,a)&&(s.m[a]=o[a]);for(l&&l(s);n.length;)e[n.pop()]=1;r(t)}})(),t=s.x,s.x=()=>s.e(941).then(t),s.x()})();