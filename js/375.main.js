(()=>{"use strict";var e,t,r={375:(e,t,r)=>{var n=r(941);class o{state=null;children=[];parent=null;move={};v=0;N=0;n=0}const s=new n.qQ,a=new class{predict(e,t,r,s=6){if(t)return-1;let a=e.state.moves(),l={},i=e.state.fen();for(a.forEach((t=>{let r=new n.qQ(i),s=r.move(t),a=new o;a.state=r,a.parent=e,a.move=s,e.children.push(a),l[t]=a}));s>0;){if(r){let t=Number.MIN_SAFE_INTEGER,r=null;for(const n in e.children){const o=e.children[n];let s=this.#e(o);s>=t&&(t=s,r=o)}let n=this.#t(r,0);const{reward:o,state:s}=this.#r(n);e=this.#n(s,o)}else{let t=Number.MAX_SAFE_INTEGER,r=null;for(const n in e.children){const o=e.children[n];let s=this.#e(o);s<=t&&(t=s,r=o)}let n=this.#t(r,1);const{reward:o,state:s}=this.#r(n);e=this.#n(s,o)}s--}let c="";if(r){let t=Number.MIN_SAFE_INTEGER;for(const r in e.children){const n=e.children[r];let o=this.#e(n);if(o>t){t=o;for(const e in l)if(n==l[e]){c=e;break}}}}else{let t=Number.MAX_SAFE_INTEGER;for(const r in e.children){const n=e.children[r];let o=this.#e(n);if(o<t){t=o;for(const e in l)if(n==l[e]){c=e;break}}}}return c}#t(e,t){if(0==e.children.length)return e;if(t){let t=Number.MIN_SAFE_INTEGER,r=null;for(const n in e.children){const o=e.children[n];let s=this.#e(o);s>t&&(t=s,r=o)}return this.#t(r,0)}{let t=Number.MAX_SAFE_INTEGER,r=null;for(const n in e.children){const o=e.children[n];let s=this.#e(o);s<t&&(t=s,r=o)}return this.#t(r,1)}}#r(e){if(e.state.game_over()){let t;return e.state.in_checkmate()||e.state.in_stalemate()?t="w"==e.state.turn()?-1:1:e.state.in_draw()?t=.5:e.state.in_threefold_repetition()&&(t=0),{reward:t,state:e}}let t=e.state.moves(),r=e.state.fen();t.forEach((t=>{let s=new n.qQ(r),a=s.move(t),l=new o;l.parent=e,l.state=s,l.move=a,e.children.push(l)}));let s=Math.floor(Math.random()*e.children.length),a=e.children[s];return this.#r(a)}#n(e,t){for(;null!=e.parent;)e.state.in_check()&&("w"==e.state.turn()?t-=.8:t+=.8),e.n++,e.v+=t,(e=e.parent).N++;return e}#e(e){let t,r=e.v;return t="b"==e.state.turn()?1.5*Math.sqrt(Math.log(e.N+Math.E+Math.pow(10,-8))/(e.n+Math.floor(4*Math.random()+1))):-1.5*Math.sqrt(Math.log(e.N+Math.E+Math.pow(10,-8))/(e.n+Math.floor(4*Math.random()+1))),r+=t,r+=.8*this.#o(e.state),r+=.5*this.#s(e.state),r+=.7*this.#a(e.state),r+=.15*this.#l(e.state),r}#o(e){let t=e.fen().split(" ")[0],r=(t.match(/P/g)||[]).length+3*(t.match(/N/g)||[]).length+3*(t.match(/B/g)||[]).length+5*(t.match(/R/g)||[]).length+9*(t.match(/Q/g)||[]).length+35*(t.match(/K/g)||[]).length,n=(t.match(/p/g)||[]).length,o=3*(t.match(/n/g)||[]).length,s=3*(t.match(/b/g)||[]).length,a=5*(t.match(/r/g)||[]).length;return r-(9*(t.match(/q/g)||[]).length+a+s+o+n+35*(t.match(/K/g)||[]).length)}#s(e){let t=e.turn(),r=e.fen(),n=0,o=0;return e.undo(),"w"==t?(n=e.moves().length,e.load(r),o=e.moves().length):(o=e.moves().length,e.load(r),n=e.moves().length),o-n}#a(e){let t=0;return e.moves({verbose:!0}).filter((e=>"c"==e.flags)).forEach((r=>{"w"==e.turn()?"w"==r.color&&(t+=1*this.#i(r.captured)):"b"==r.color&&(t+=-1*this.#i(r.captured))})),t}#l(e){let t=0;return e.moves({verbose:!0}).filter((e=>"cp"==e.flags||"np"==e.flags)).forEach((e=>{"w"==e.color?t+=1*this.#i(e.promotion):t+=-1*this.#i(e.promotion)})),t}#i(e){switch(e){case"P":case"p":return 1;case"B":case"b":case"N":case"n":return 3;case"R":case"r":return 5;case"Q":case"q":return 9;case"K":case"k":return 35}}};let l=!0;for(;!s.game_over();){const e=new o;e.state=s,l?console.log("white is deciding"):console.log("black is deciding");let t=a.predict(e,s.game_over(),l),r=s.move(t);self.postMessage({type:"move",move:r}),l=!l}console.log(s.pgn()),self.postMessage({type:"finished",is_draw:s.in_draw()||s.in_threefold_repetition(),turn:s.turn(),is_checkmate:s.in_checkmate()||s.in_stalemate()})}},n={};function o(e){var t=n[e];if(void 0!==t)return t.exports;var s=n[e]={exports:{}};return r[e](s,s.exports,o),s.exports}o.m=r,o.x=()=>{var e=o.O(void 0,[941],(()=>o(375)));return o.O(e)},e=[],o.O=(t,r,n,s)=>{if(!r){var a=1/0;for(h=0;h<e.length;h++){for(var[r,n,s]=e[h],l=!0,i=0;i<r.length;i++)(!1&s||a>=s)&&Object.keys(o.O).every((e=>o.O[e](r[i])))?r.splice(i--,1):(l=!1,s<a&&(a=s));if(l){e.splice(h--,1);var c=n();void 0!==c&&(t=c)}}return t}s=s||0;for(var h=e.length;h>0&&e[h-1][2]>s;h--)e[h]=e[h-1];e[h]=[r,n,s]},o.d=(e,t)=>{for(var r in t)o.o(t,r)&&!o.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},o.f={},o.e=e=>Promise.all(Object.keys(o.f).reduce(((t,r)=>(o.f[r](e,t),t)),[])),o.u=e=>e+".main.js",o.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),o.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{var e;o.g.importScripts&&(e=o.g.location+"");var t=o.g.document;if(!e&&t&&(t.currentScript&&(e=t.currentScript.src),!e)){var r=t.getElementsByTagName("script");r.length&&(e=r[r.length-1].src)}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),o.p=e})(),(()=>{var e={375:1};o.f.i=(t,r)=>{e[t]||importScripts(o.p+o.u(t))};var t=self.webpackChunkchess=self.webpackChunkchess||[],r=t.push.bind(t);t.push=t=>{var[n,s,a]=t;for(var l in s)o.o(s,l)&&(o.m[l]=s[l]);for(a&&a(o);n.length;)e[n.pop()]=1;r(t)}})(),t=o.x,o.x=()=>o.e(941).then(t),o.x()})();