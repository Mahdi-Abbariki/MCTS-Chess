(()=>{"use strict";var e,t,r={375:(e,t,r)=>{var n=r(941);class s{state=null;children=[];parent=null;move={};v=0;N=0;n=0}const a=new n.qQ,o=new class{predict(e,t,r,a=6){if(t)return-1;let o=e.state.moves(),i={},l=e.state.fen();for(o.forEach((t=>{let r=new n.qQ(l),a=r.move(t),o=new s;o.state=r,o.parent=e,o.move=a,e.children.push(o),i[t]=o}));a>0;){if(r){let t=Number.MIN_SAFE_INTEGER,r=null;for(const n in e.children){const s=e.children[n];let a=this.#e(s);a>=t&&(t=a,r=s)}let n=this.#t(r,0);const{reward:s,state:a}=this.#r(n);e=this.#n(a,s)}else{let t=Number.MAX_SAFE_INTEGER,r=null;for(const n in e.children){const s=e.children[n];let a=this.#e(s);a<=t&&(t=a,r=s)}let n=this.#t(r,1);const{reward:s,state:a}=this.#r(n);e=this.#n(a,s)}a--}let c="";if(r){let t=Number.MIN_SAFE_INTEGER;for(const r in e.children){const n=e.children[r];let s=this.#e(n);if(s>t){t=s;for(const e in i)if(n==i[e]){c=e;break}}}}else{let t=Number.MAX_SAFE_INTEGER;for(const r in e.children){const n=e.children[r];let s=this.#e(n);if(s<t){t=s;for(const e in i)if(n==i[e]){c=e;break}}}}return c}#t(e,t){if(0==e.children.length)return e;if(t){let t=Number.MIN_SAFE_INTEGER,r=null;for(const n in e.children){const s=e.children[n];let a=this.#e(s);a>t&&(t=a,r=s)}return this.#t(r,0)}{let t=Number.MAX_SAFE_INTEGER,r=null;for(const n in e.children){const s=e.children[n];let a=this.#e(s);a<t&&(t=a,r=s)}return this.#t(r,1)}}#r(e){if(e.state.game_over()){let t;return e.state.in_checkmate()||e.state.in_stalemate()?t="w"==e.state.turn()?-1:1:e.state.in_draw()?t=.5:e.state.in_threefold_repetition()&&(t=0),{reward:t,state:e}}let t=e.state.moves(),r=e.state.fen();t.forEach((t=>{let a=new n.qQ(r),o=a.move(t),i=new s;i.parent=e,i.state=a,i.move=o,e.children.push(i)}));let a=Math.floor(Math.random()*e.children.length),o=e.children[a];return this.#r(o)}#n(e,t){for(;null!=e.parent;)e.state.in_check()&&("w"==e.state.turn()?t-=.8:t+=.8),e.n++,e.v+=t,(e=e.parent).N++;return e}#e(e){let t,r=e.v;return t="b"==e.state.turn()?1.5*Math.sqrt(Math.log(e.N+Math.E+Math.pow(10,-8))/(e.n+Math.floor(4*Math.random()+1))):-1.5*Math.sqrt(Math.log(e.N+Math.E+Math.pow(10,-8))/(e.n+Math.floor(4*Math.random()+1))),r+=t,r+=.8*this.#s(e.state),r+=.5*this.#a(e.state),r+=.8*this.#o(e.state),r+=.15*this.#i(e.state),r}#s(e){let t=e.fen().split(" ")[0],r=(t.match(/P/g)||[]).length*this.#l("p")+(t.match(/N/g)||[]).length*this.#l("n")+(t.match(/B/g)||[]).length*this.#l("b")+(t.match(/R/g)||[]).length*this.#l("r")+(t.match(/Q/g)||[]).length*this.#l("q")+(t.match(/K/g)||[]).length*this.#l("k"),n=(t.match(/p/g)||[]).length*this.#l("p"),s=(t.match(/n/g)||[]).length*this.#l("n"),a=(t.match(/b/g)||[]).length*this.#l("b"),o=(t.match(/r/g)||[]).length*this.#l("r");return r-((t.match(/q/g)||[]).length*this.#l("q")+o+a+s+n+(t.match(/K/g)||[]).length*this.#l("k"))}#a(e){let t=e.turn(),r=e.fen(),n=0,s=0;return e.undo(),"w"==t?(n=e.moves().length,e.load(r),s=e.moves().length):(s=e.moves().length,e.load(r),n=e.moves().length),s-n}#o(e){let t=0;return e.moves({verbose:!0}).filter((e=>"c"==e.flags)).forEach((r=>{"w"==e.turn()?"w"==r.color&&(t+=1*this.#l(r.captured)):"b"==r.color&&(t+=-1*this.#l(r.captured))})),t}#i(e){let t=0;return e.moves({verbose:!0}).filter((e=>"cp"==e.flags||"np"==e.flags)).forEach((e=>{"w"==e.color?t+=1*this.#l(e.promotion):t+=-1*this.#l(e.promotion)})),t}#l(e){switch(e){case"P":case"p":return 1;case"B":case"b":case"N":case"n":return 3;case"R":case"r":return 5;case"Q":case"q":return 9;case"K":case"k":return 30}}};let i=!0;for(;!a.game_over();){const e=new s;e.state=a,i?console.log("white is deciding"):console.log("black is deciding");let t=o.predict(e,a.game_over(),i),r=a.move(t);self.postMessage({type:"move",move:r}),i=!i}console.log(a.pgn()),self.postMessage({type:"finished",is_draw:a.in_draw()||a.in_threefold_repetition(),turn:a.turn(),is_checkmate:a.in_checkmate()||a.in_stalemate()})}},n={};function s(e){var t=n[e];if(void 0!==t)return t.exports;var a=n[e]={exports:{}};return r[e](a,a.exports,s),a.exports}s.m=r,s.x=()=>{var e=s.O(void 0,[941],(()=>s(375)));return s.O(e)},e=[],s.O=(t,r,n,a)=>{if(!r){var o=1/0;for(h=0;h<e.length;h++){for(var[r,n,a]=e[h],i=!0,l=0;l<r.length;l++)(!1&a||o>=a)&&Object.keys(s.O).every((e=>s.O[e](r[l])))?r.splice(l--,1):(i=!1,a<o&&(o=a));if(i){e.splice(h--,1);var c=n();void 0!==c&&(t=c)}}return t}a=a||0;for(var h=e.length;h>0&&e[h-1][2]>a;h--)e[h]=e[h-1];e[h]=[r,n,a]},s.d=(e,t)=>{for(var r in t)s.o(t,r)&&!s.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},s.f={},s.e=e=>Promise.all(Object.keys(s.f).reduce(((t,r)=>(s.f[r](e,t),t)),[])),s.u=e=>e+".main.js",s.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),s.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{var e;s.g.importScripts&&(e=s.g.location+"");var t=s.g.document;if(!e&&t&&(t.currentScript&&(e=t.currentScript.src),!e)){var r=t.getElementsByTagName("script");r.length&&(e=r[r.length-1].src)}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),s.p=e})(),(()=>{var e={375:1};s.f.i=(t,r)=>{e[t]||importScripts(s.p+s.u(t))};var t=self.webpackChunkchess=self.webpackChunkchess||[],r=t.push.bind(t);t.push=t=>{var[n,a,o]=t;for(var i in a)s.o(a,i)&&(s.m[i]=a[i]);for(o&&o(s);n.length;)e[n.pop()]=1;r(t)}})(),t=s.x,s.x=()=>s.e(941).then(t),s.x()})();