(()=>{"use strict";const e="rnbqkbnr/pppppppp/8/8/8/8/PPPPPPPP/RNBQKBNR w KQkq - 0 1",r=["1-0","0-1","1/2-1/2","*"],n={b:[16,32,17,15],w:[-16,-32,-17,-15]},t={n:[-18,-33,-31,-14,18,33,31,14],b:[-17,-15,17,15],r:[-16,1,16,-1],q:[-17,-16,-15,1,17,16,15,-1],k:[-17,-16,-15,1,17,16,15,-1]},o=[20,0,0,0,0,0,0,24,0,0,0,0,0,0,20,0,0,20,0,0,0,0,0,24,0,0,0,0,0,20,0,0,0,0,20,0,0,0,0,24,0,0,0,0,20,0,0,0,0,0,0,20,0,0,0,24,0,0,0,20,0,0,0,0,0,0,0,0,20,0,0,24,0,0,20,0,0,0,0,0,0,0,0,0,0,20,2,24,2,20,0,0,0,0,0,0,0,0,0,0,0,2,53,56,53,2,0,0,0,0,0,0,24,24,24,24,24,24,56,0,56,24,24,24,24,24,24,0,0,0,0,0,0,2,53,56,53,2,0,0,0,0,0,0,0,0,0,0,0,20,2,24,2,20,0,0,0,0,0,0,0,0,0,0,20,0,0,24,0,0,20,0,0,0,0,0,0,0,0,20,0,0,0,24,0,0,0,20,0,0,0,0,0,0,20,0,0,0,0,24,0,0,0,0,20,0,0,0,0,20,0,0,0,0,0,24,0,0,0,0,0,20,0,0,20,0,0,0,0,0,0,24,0,0,0,0,0,0,20],i=[17,0,0,0,0,0,0,16,0,0,0,0,0,0,15,0,0,17,0,0,0,0,0,16,0,0,0,0,0,15,0,0,0,0,17,0,0,0,0,16,0,0,0,0,15,0,0,0,0,0,0,17,0,0,0,16,0,0,0,15,0,0,0,0,0,0,0,0,17,0,0,16,0,0,15,0,0,0,0,0,0,0,0,0,0,17,0,16,0,15,0,0,0,0,0,0,0,0,0,0,0,0,17,16,15,0,0,0,0,0,0,0,1,1,1,1,1,1,1,0,-1,-1,-1,-1,-1,-1,-1,0,0,0,0,0,0,0,-15,-16,-17,0,0,0,0,0,0,0,0,0,0,0,0,-15,0,-16,0,-17,0,0,0,0,0,0,0,0,0,0,-15,0,0,-16,0,0,-17,0,0,0,0,0,0,0,0,-15,0,0,0,-16,0,0,0,-17,0,0,0,0,0,0,-15,0,0,0,0,-16,0,0,0,0,-17,0,0,0,0,-15,0,0,0,0,0,-16,0,0,0,0,0,-17,0,0,-15,0,0,0,0,0,0,-16,0,0,0,0,0,0,-17],a={p:0,n:1,b:2,r:3,q:4,k:5},f={NORMAL:1,CAPTURE:2,BIG_PAWN:4,EP_CAPTURE:8,PROMOTION:16,KSIDE_CASTLE:32,QSIDE_CASTLE:64},l={a8:0,b8:1,c8:2,d8:3,e8:4,f8:5,g8:6,h8:7,a7:16,b7:17,c7:18,d7:19,e7:20,f7:21,g7:22,h7:23,a6:32,b6:33,c6:34,d6:35,e6:36,f6:37,g6:38,h6:39,a5:48,b5:49,c5:50,d5:51,e5:52,f5:53,g5:54,h5:55,a4:64,b4:65,c4:66,d4:67,e4:68,f4:69,g4:70,h4:71,a3:80,b3:81,c3:82,d3:83,e3:84,f3:85,g3:86,h3:87,a2:96,b2:97,c2:98,d2:99,e2:100,f2:101,g2:102,h2:103,a1:112,b1:113,c1:114,d1:115,e1:116,f1:117,g1:118,h1:119},u={w:[{square:l.a1,flag:f.QSIDE_CASTLE},{square:l.h1,flag:f.KSIDE_CASTLE}],b:[{square:l.a8,flag:f.QSIDE_CASTLE},{square:l.h8,flag:f.KSIDE_CASTLE}]};function s(e){var r=e.charAt(0);if(r>="a"&&r<="h"){if(e.match(/[a-h]\d.*[a-h]\d/))return;return y}return"o"===(r=r.toLowerCase())?C:r}function c(e){return e.replace(/=/,"").replace(/[+#]?[?!]*$/,"")}function p(e){return e>>4}function v(e){return 15&e}function g(e){var r=v(e),n=p(e);return"abcdefgh".substring(r,r+1)+"87654321".substring(n,n+1)}function h(e){return e===E?b:E}function d(e){var r=e instanceof Array?[]:{};for(var n in e)r[n]="object"==typeof n?d(e[n]):e[n];return r}function m(e){return e.replace(/^\s+|\s+$/g,"")}const b="b",E="w",_=-1,y="p",C="k",A=(function(){for(var e=[],r=l.a8;r<=l.h1;r++)136&r?r+=7:e.push(g(r))}(),{NORMAL:"n",CAPTURE:"c",BIG_PAWN:"b",EP_CAPTURE:"e",PROMOTION:"p",KSIDE_CASTLE:"k",QSIDE_CASTLE:"q"}),S=new function(S){var w=new Array(128),T={w:_,b:_},I=E,L={w:0,b:0},P=_,R=0,k=1,O=[],q={},N={};function D(e){void 0===e&&(e=!1),w=new Array(128),T={w:_,b:_},I=E,L={w:0,b:0},P=_,R=0,k=1,O=[],e||(q={}),N={},B(j())}function Q(){for(var e=[],r={},n=function(e){e in N&&(r[e]=N[e])};O.length>0;)e.push(ne());for(n(j());e.length>0;)re(e.pop()),n(j());N=r}function U(){K(e)}function K(e,r){void 0===r&&(r=!1);var n=e.split(/\s+/),t=n[0],o=0;if(!x(e).valid)return!1;D(r);for(var i=0;i<t.length;i++){var a=t.charAt(i);if("/"===a)o+=8;else if(-1!=="0123456789".indexOf(a))o+=parseInt(a,10);else{var u=a<"a"?E:b;W({type:a.toLowerCase(),color:u},g(o)),o++}}return I=n[1],n[2].indexOf("K")>-1&&(L.w|=f.KSIDE_CASTLE),n[2].indexOf("Q")>-1&&(L.w|=f.QSIDE_CASTLE),n[2].indexOf("k")>-1&&(L.b|=f.KSIDE_CASTLE),n[2].indexOf("q")>-1&&(L.b|=f.QSIDE_CASTLE),P="-"===n[3]?_:l[n[3]],R=parseInt(n[4],10),k=parseInt(n[5],10),B(j()),!0}function x(e){var r=e.split(/\s+/);if(6!==r.length)return{valid:!1,error_number:1,error:"FEN string must contain six space-delimited fields."};if(isNaN(r[5])||parseInt(r[5],10)<=0)return{valid:!1,error_number:2,error:"6th field (move number) must be a positive integer."};if(isNaN(r[4])||parseInt(r[4],10)<0)return{valid:!1,error_number:3,error:"5th field (half move counter) must be a non-negative integer."};if(!/^(-|[abcdefgh][36])$/.test(r[3]))return{valid:!1,error_number:4,error:"4th field (en-passant square) is invalid."};if(!/^(KQ?k?q?|Qk?q?|kq?|q|-)$/.test(r[2]))return{valid:!1,error_number:5,error:"3rd field (castling availability) is invalid."};if(!/^(w|b)$/.test(r[1]))return{valid:!1,error_number:6,error:"2nd field (side to move) is invalid."};var n=r[0].split("/");if(8!==n.length)return{valid:!1,error_number:7,error:"1st field (piece positions) does not contain 8 '/'-delimited rows."};for(var t=0;t<n.length;t++){for(var o=0,i=!1,a=0;a<n[t].length;a++)if(isNaN(n[t][a])){if(!/^[prnbqkPRNBQK]$/.test(n[t][a]))return{valid:!1,error_number:9,error:"1st field (piece positions) is invalid [invalid piece]."};o+=1,i=!1}else{if(i)return{valid:!1,error_number:8,error:"1st field (piece positions) is invalid [consecutive numbers]."};o+=parseInt(n[t][a],10),i=!0}if(8!==o)return{valid:!1,error_number:10,error:"1st field (piece positions) is invalid [row too large]."}}return"3"==r[3][1]&&"w"==r[1]||"6"==r[3][1]&&"b"==r[1]?{valid:!1,error_number:11,error:"Illegal en-passant square"}:{valid:!0,error_number:0,error:"No errors."}}function j(){for(var e=0,r="",n=l.a8;n<=l.h1;n++){if(null==w[n])e++;else{e>0&&(r+=e,e=0);var t=w[n].color,o=w[n].type;r+=t===E?o.toUpperCase():o.toLowerCase()}n+1&136&&(e>0&&(r+=e),n!==l.h1&&(r+="/"),e=0,n+=8)}var i="";L[E]&f.KSIDE_CASTLE&&(i+="K"),L[E]&f.QSIDE_CASTLE&&(i+="Q"),L[b]&f.KSIDE_CASTLE&&(i+="k"),L[b]&f.QSIDE_CASTLE&&(i+="q"),i=i||"-";var a=P===_?"-":g(P);return[r,I,i,a,R,k].join(" ")}function $(e){for(var r=0;r<e.length;r+=2)"string"==typeof e[r]&&"string"==typeof e[r+1]&&(q[e[r]]=e[r+1]);return q}function B(r){O.length>0||(r!==e?(q.SetUp="1",q.FEN=r):(delete q.SetUp,delete q.FEN))}function M(e){var r=w[l[e]];return r?{type:r.type,color:r.color}:null}function W(e,r){if(!("type"in e)||!("color"in e))return!1;if(-1==="pnbrqkPNBRQK".indexOf(e.type.toLowerCase()))return!1;if(!(r in l))return!1;var n=l[r];return(e.type!=C||T[e.color]==_||T[e.color]==n)&&(w[n]={type:e.type,color:e.color},e.type===C&&(T[e.color]=n),B(j()),!0)}function F(e,r,n,t,o){var i={color:I,from:r,to:n,flags:t,piece:e[r].type};return o&&(i.flags|=f.PROMOTION,i.promotion=o),e[n]?i.captured=e[n].type:t&f.EP_CAPTURE&&(i.captured=y),i}function G(e){function r(e,r,n,t,o){if(e[n].type!==y||0!==p(t)&&7!==p(t))r.push(F(e,n,t,o));else for(var i=["q","r","b","n"],a=0,f=i.length;a<f;a++)r.push(F(e,n,t,o,i[a]))}var o=[],i=I,a=h(i),u={b:1,w:6},s=l.a8,c=l.h1,v=!1,g=void 0===e||!("legal"in e)||e.legal,d=void 0===e||!("piece"in e)||"string"!=typeof e.piece||e.piece.toLowerCase();if(void 0!==e&&"square"in e){if(!(e.square in l))return[];s=c=l[e.square],v=!0}for(var m=s;m<=c;m++)if(136&m)m+=7;else{var b=w[m];if(null!=b&&b.color===i)if(b.type!==y||!0!==d&&d!==y){if(!0===d||d===b.type)for(var E=0,_=t[b.type].length;E<_;E++){var A=t[b.type][E];for(S=m;!(136&(S+=A));){if(null!=w[S]){if(w[S].color===i)break;r(w,o,m,S,f.CAPTURE);break}if(r(w,o,m,S,f.NORMAL),"n"===b.type||"k"===b.type)break}}}else{var S=m+n[i][0];if(null==w[S]){r(w,o,m,S,f.NORMAL);S=m+n[i][1];u[i]===p(m)&&null==w[S]&&r(w,o,m,S,f.BIG_PAWN)}for(E=2;E<4;E++)136&(S=m+n[i][E])||(null!=w[S]&&w[S].color===a?r(w,o,m,S,f.CAPTURE):S===P&&r(w,o,m,P,f.EP_CAPTURE))}}if(!(!0!==d&&d!==C||v&&c!==T[i])){if(L[i]&f.KSIDE_CASTLE){var R=(k=T[i])+2;null!=w[k+1]||null!=w[R]||Z(a,T[i])||Z(a,k+1)||Z(a,R)||r(w,o,T[i],R,f.KSIDE_CASTLE)}var k;if(L[i]&f.QSIDE_CASTLE)R=(k=T[i])-2,null!=w[k-1]||null!=w[k-2]||null!=w[k-3]||Z(a,T[i])||Z(a,k-1)||Z(a,R)||r(w,o,T[i],R,f.QSIDE_CASTLE)}if(!g)return o;var O=[];for(m=0,_=o.length;m<_;m++)re(o[m]),H(i)||O.push(o[m]),ne();return O}function z(e,r){var n="";if(e.flags&f.KSIDE_CASTLE)n="O-O";else if(e.flags&f.QSIDE_CASTLE)n="O-O-O";else{if(e.piece!==y){var t=function(e,r){for(var n=e.from,t=e.to,o=e.piece,i=0,a=0,f=0,l=0,u=r.length;l<u;l++){var s=r[l].from,c=r[l].to;o===r[l].piece&&n!==s&&t===c&&(i++,p(n)===p(s)&&a++,v(n)===v(s)&&f++)}return i>0?a>0&&f>0?g(n):f>0?g(n).charAt(1):g(n).charAt(0):""}(e,r);n+=e.piece.toUpperCase()+t}e.flags&(f.CAPTURE|f.EP_CAPTURE)&&(e.piece===y&&(n+=g(e.from)[0]),n+="x"),n+=g(e.to),e.flags&f.PROMOTION&&(n+="="+e.promotion.toUpperCase())}return re(e),J()&&(V()?n+="#":n+="+"),ne(),n}function Z(e,r){for(var n=l.a8;n<=l.h1;n++)if(136&n)n+=7;else if(null!=w[n]&&w[n].color===e){var t=w[n],f=n-r,u=f+119;if(o[u]&1<<a[t.type]){if(t.type===y){if(f>0){if(t.color===E)return!0}else if(t.color===b)return!0;continue}if("n"===t.type||"k"===t.type)return!0;for(var s=i[u],c=n+s,p=!1;c!==r;){if(null!=w[c]){p=!0;break}c+=s}if(!p)return!0}}return!1}function H(e){return Z(h(e),T[e])}function J(){return H(I)}function V(){return J()&&0===G().length}function X(){return!J()&&0===G().length}function Y(){for(var e={},r=[],n=0,t=0,o=l.a8;o<=l.h1;o++)if(t=(t+1)%2,136&o)o+=7;else{var i=w[o];i&&(e[i.type]=i.type in e?e[i.type]+1:1,"b"===i.type&&r.push(t),n++)}if(2===n)return!0;if(3===n&&(1===e.b||1===e.n))return!0;if(n===e.b+2){var a=0,f=r.length;for(o=0;o<f;o++)a+=r[o];if(0===a||a===f)return!0}return!1}function ee(){for(var e=[],r={},n=!1;;){var t=ne();if(!t)break;e.push(t)}for(;;){var o=j().split(" ").slice(0,4).join(" ");if(r[o]=o in r?r[o]+1:1,r[o]>=3&&(n=!0),!e.length)break;re(e.pop())}return n}function re(e){var r=I,n=h(r);if(function(e){O.push({move:e,kings:{b:T.b,w:T.w},turn:I,castling:{b:L.b,w:L.w},ep_square:P,half_moves:R,move_number:k})}(e),w[e.to]=w[e.from],w[e.from]=null,e.flags&f.EP_CAPTURE&&(I===b?w[e.to-16]=null:w[e.to+16]=null),e.flags&f.PROMOTION&&(w[e.to]={type:e.promotion,color:r}),w[e.to].type===C){if(T[w[e.to].color]=e.to,e.flags&f.KSIDE_CASTLE){var t=e.to-1,o=e.to+1;w[t]=w[o],w[o]=null}else e.flags&f.QSIDE_CASTLE&&(t=e.to+1,o=e.to-2,w[t]=w[o],w[o]=null);L[r]=""}if(L[r])for(var i=0,a=u[r].length;i<a;i++)if(e.from===u[r][i].square&&L[r]&u[r][i].flag){L[r]^=u[r][i].flag;break}if(L[n])for(i=0,a=u[n].length;i<a;i++)if(e.to===u[n][i].square&&L[n]&u[n][i].flag){L[n]^=u[n][i].flag;break}P=e.flags&f.BIG_PAWN?"b"===I?e.to-16:e.to+16:_,e.piece===y||e.flags&(f.CAPTURE|f.EP_CAPTURE)?R=0:R++,I===b&&k++,I=h(I)}function ne(){var e=O.pop();if(null==e)return null;var r=e.move;T=e.kings,I=e.turn,L=e.castling,P=e.ep_square,R=e.half_moves,k=e.move_number;var n,t,o=I,i=h(I);if(w[r.from]=w[r.to],w[r.from].type=r.piece,w[r.to]=null,r.flags&f.CAPTURE)w[r.to]={type:r.captured,color:i};else if(r.flags&f.EP_CAPTURE){var a;a=o===b?r.to-16:r.to+16,w[a]={type:y,color:i}}return r.flags&(f.KSIDE_CASTLE|f.QSIDE_CASTLE)&&(r.flags&f.KSIDE_CASTLE?(n=r.to+1,t=r.to-1):r.flags&f.QSIDE_CASTLE&&(n=r.to-2,t=r.to+1),w[n]=w[t],w[t]=null),r}function te(e,r){for(var n=c(e),t=0;t<2;t++){if(1==t){if(!r)return null;var o=!1;if(p=n.match(/([pnbrqkPNBRQK])?([a-h][1-8])x?-?([a-h][1-8])([qrbnQRBN])?/)){var i=p[1],a=p[2],f=p[3],u=p[4];1==a.length&&(o=!0)}else{var p;(p=n.match(/([pnbrqkPNBRQK])?([a-h]?[1-8]?)x?-?([a-h][1-8])([qrbnQRBN])?/))&&(i=p[1],a=p[2],f=p[3],u=p[4],1==a.length&&(o=!0))}}for(var v=s(n),h=G({legal:!0,piece:i||v}),d=0,m=h.length;d<m;d++)switch(t){case 0:if(n===c(z(h[d],h)))return h[d];break;case 1:if(p){if(!(i&&i.toLowerCase()!=h[d].piece||l[a]!=h[d].from||l[f]!=h[d].to||u&&u.toLowerCase()!=h[d].promotion))return h[d];if(o){var b=g(h[d].from);if(!(i&&i.toLowerCase()!=h[d].piece||l[f]!=h[d].to||a!=b[0]&&a!=b[1]||u&&u.toLowerCase()!=h[d].promotion))return h[d]}}}}return null}function oe(e){var r=d(e);r.san=z(r,G({legal:!0})),r.to=g(r.to),r.from=g(r.from);var n="";for(var t in f)f[t]&r.flags&&(n+=A[t]);return r.flags=n,r}function ie(e){for(var r=G({legal:!1}),n=0,t=I,o=0,i=r.length;o<i;o++)re(r[o]),H(t)||(e-1>0?n+=ie(e-1):n++),ne();return n}return K(e),{load:function(e){return K(e)},reset:function(){return U()},moves:function(e){for(var r=G(e),n=[],t=0,o=r.length;t<o;t++)void 0!==e&&"verbose"in e&&e.verbose?n.push(oe(r[t])):n.push(z(r[t],G({legal:!0})));return n},in_check:function(){return J()},in_checkmate:function(){return V()},in_stalemate:function(){return X()},in_draw:function(){return R>=100||X()||Y()||ee()},insufficient_material:function(){return Y()},in_threefold_repetition:function(){return ee()},game_over:function(){return R>=100||V()||X()||Y()||ee()},validate_fen:function(e){return x(e)},fen:function(){return j()},board:function(){for(var e=[],r=[],n=l.a8;n<=l.h1;n++)null==w[n]?r.push(null):r.push({square:g(n),type:w[n].type,color:w[n].color}),n+1&136&&(e.push(r),r=[],n+=8);return e},pgn:function(e){var r="object"==typeof e&&"string"==typeof e.newline_char?e.newline_char:"\n",n="object"==typeof e&&"number"==typeof e.max_width?e.max_width:0,t=[],o=!1;for(var i in q)t.push("["+i+' "'+q[i]+'"]'+r),o=!0;o&&O.length&&t.push(r);for(var a=function(e){var r=N[j()];return void 0!==r&&(e=`${e}${e.length>0?" ":""}{${r}}`),e},f=[];O.length>0;)f.push(ne());var l=[],u="";for(0===f.length&&l.push(a(""));f.length>0;){u=a(u);var s=f.pop();O.length||"b"!==s.color?"w"===s.color&&(u.length&&l.push(u),u=k+"."):u=k+". ...",u=u+" "+z(s,G({legal:!0})),re(s)}if(u.length&&l.push(a(u)),void 0!==q.Result&&l.push(q.Result),0===n)return t.join("")+l.join(" ");var c=function(){return t.length>0&&" "===t[t.length-1]&&(t.pop(),!0)},p=function(e,o){for(var i of o.split(" "))if(i){if(e+i.length>n){for(;c();)e--;t.push(r),e=0}t.push(i),e+=i.length,t.push(" "),e++}return c()&&e--,e},v=0;for(i=0;i<l.length;i++)v+l[i].length>n&&l[i].includes("{")?v=p(v,l[i]):(v+l[i].length>n&&0!==i?(" "===t[t.length-1]&&t.pop(),t.push(r),v=0):0!==i&&(t.push(" "),v++),t.push(l[i]),v+=l[i].length);return t.join("")},load_pgn:function(e,n){var t=void 0!==n&&"sloppy"in n&&n.sloppy;function o(e){return e.replace(/\\/g,"\\")}e=e.trim();var i="object"==typeof n&&"string"==typeof n.newline_char?n.newline_char:"\r?\n",a=new RegExp("^(\\[((?:"+o(i)+")|.)*\\])(?:\\s*"+o(i)+"){2}"),f=a.test(e)?a.exec(e)[1]:"";U();var l=function(e,r){for(var n="object"==typeof r&&"string"==typeof r.newline_char?r.newline_char:"\r?\n",t={},i=e.split(new RegExp(o(n))),a="",f="",l=0;l<i.length;l++){var u=/^\s*\[([A-Za-z]+)\s*"(.*)"\s*\]\s*$/;a=i[l].replace(u,"$1"),f=i[l].replace(u,"$2"),m(a).length>0&&(t[a]=f)}return t}(f,n),u="";for(var s in l)"fen"===s.toLowerCase()&&(u=l[s]),$([s,l[s]]);if(t){if(u&&!K(u,!0))return!1}else if(!("1"!==l.SetUp||"FEN"in l&&K(l.FEN,!0)))return!1;for(var c=function(e){return`{${function(e){return Array.from(e).map((function(e){return e.charCodeAt(0)<128?e.charCodeAt(0).toString(16):encodeURIComponent(e).replace(/\%/g,"").toLowerCase()})).join("")}((e=e.replace(new RegExp(o(i),"g")," ")).slice(1,e.length-1))}}`},p=function(e){if(e.startsWith("{")&&e.endsWith("}"))return function(e){return 0==e.length?"":decodeURIComponent("%"+e.match(/.{1,2}/g).join("%"))}(e.slice(1,e.length-1))},v=e.replace(f,"").replace(new RegExp(`({[^}]*})+?|;([^${o(i)}]*)`,"g"),(function(e,r,n){return void 0!==r?c(r):" "+c(`{${n.slice(1)}}`)})).replace(new RegExp(o(i),"g")," "),g=/(\([^\(\)]+\))+?/g;g.test(v);)v=v.replace(g,"");var h=m(v=(v=(v=v.replace(/\d+\.(\.\.)?/g,"")).replace(/\.\.\./g,"")).replace(/\$\d+/g,"")).split(new RegExp(/\s+/));h=h.join(",").replace(/,,+/g,",").split(",");for(var d="",b="",E=0;E<h.length;E++){var _=p(h[E]);if(void 0===_)if(null==(d=te(h[E],t))){if(!(r.indexOf(h[E])>-1))return!1;b=h[E]}else b="",re(d);else N[j()]=_}return b&&Object.keys(q).length&&!q.Result&&$(["Result",b]),!0},header:function(){return $(arguments)},turn:function(){return I},move:function(e,r){var n=void 0!==r&&"sloppy"in r&&r.sloppy,t=null;if("string"==typeof e)t=te(e,n);else if("object"==typeof e)for(var o=G(),i=0,a=o.length;i<a;i++)if(e.from===g(o[i].from)&&e.to===g(o[i].to)&&(!("promotion"in o[i])||e.promotion===o[i].promotion)){t=o[i];break}if(!t)return null;var f=oe(t);return re(t),f},undo:function(){var e=ne();return e?oe(e):null},clear:function(){return D()},put:function(e,r){return W(e,r)},get:function(e){return M(e)},ascii(){for(var e="   +------------------------+\n",r=l.a8;r<=l.h1;r++){if(0===v(r)&&(e+=" "+"87654321"[p(r)]+" |"),null==w[r])e+=" . ";else{var n=w[r].type;e+=" "+(w[r].color===E?n.toUpperCase():n.toLowerCase())+" "}r+1&136&&(e+="|\n",r+=8)}return(e+="   +------------------------+\n")+"     a  b  c  d  e  f  g  h"},remove:function(e){return function(e){var r=M(e);return w[l[e]]=null,r&&r.type===C&&(T[r.color]=_),B(j()),r}(e)},perft:function(e){return ie(e)},square_color:function(e){if(e in l){var r=l[e];return(p(r)+v(r))%2==0?"light":"dark"}return null},history:function(e){for(var r=[],n=[],t=(void 0!==e&&"verbose"in e&&e.verbose);O.length>0;)r.push(ne());for(;r.length>0;){var o=r.pop();t?n.push(oe(o)):n.push(z(o,G({legal:!0}))),re(o)}return n},get_comment:function(){return N[j()]},set_comment:function(e){N[j()]=e.replace("{","[").replace("}","]")},delete_comment:function(){var e=N[j()];return delete N[j()],e},get_comments:function(){return Q(),Object.keys(N).map((function(e){return{fen:e,comment:N[e]}}))},delete_comments:function(){return Q(),Object.keys(N).map((function(e){var r=N[e];return delete N[e],{fen:e,comment:r}}))}}};S.move("exf4"),S.move("e4"),S.move("f6"),S.move("f4"),console.log(S.moves(),S.moves({verbose:!0}),S.ascii(),S.pgn())})();